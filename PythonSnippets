# count unique with multiple columns
df.groupby(['col_a', 'col_b']).ngroups

# transformer model
https://huggingface.co/sentence-transformers/multi-qa-MiniLM-L6-cos-v1/tree/main

from google.colab import files
files.upload()

# remove punctuation and digits in a pandas column 
df.poem = df.poem.apply(lambda x: x.translate(None, string.punctuation))
df.poem = df.poem.apply(lambda x: x.translate(None, string.digits))
# using re
df['E'] = df['B'].map(lambda x: re.sub(r'\W+', '', x))

# read muliple files
import os
os.listdir()
os.chdir(‘directory where the files are located’)
files = [file for file in os.listdir()]
df = pd.concat(map(pd.read_csv, files), ignore_index=True)
df.head()

# delete a column
del df[‘Age’]

# sorting a dataframe
df.sort(column=’Age’)

# and filter
df[(df["class"] == 'A') & (df["score"] > 80)]

# filter based on part of a string
# if you need to avoid NaNs df2["Interests"] = df2["Interests"].fillna("")
df[df["Interests"].str.contains("Reading")]
df[df["Interests"].str.contains("reading", case=False)] # ignore case
df[df["Interests"].str.contains(".*V.*")] # with wildcard


# save jupyter notebook to html

%%javascript
IPython.notebook.save_notebook()

import os
os.system('jupyter nbconvert --to html yourNotebook.ipynb')
# or with output
os.system('jupyter nbconvert --execute --to html notebook.ipynb')

# open oft file
import win32com.client as win32
outlook = win32.Dispatch('outlook.application')
mail = outlook.CreateItemFromTemplate(0)

#mail.Open() does not exist... but what instead?
mail.Open('Template1.oft')

mail.HtmlBody = alterEmail(mail.HtmlBody)
mail.Display(True)
mail.Save()
